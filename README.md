#  Проект: извлечения телефонных номеров и адресов электронной почты
## Collector of :phone: phone numbers and :email: e-mails
----------
Проект помогает если необходимо заняться рутинной работой — найти все телефонные номера и адреса электронной почты, которые содержатся на длинной веб-странице или в документе большого размера. Программа, способна выполнять поиск телефонных номеров и электронных адресов в буфере обмена, с ее помощью можно просто нажать комбинацию клавиш <Ctrl+A> для выделения всего текста и комбинацию клавиши <Ctrl+C> для копирования выделенного текста в буфер, а затем выполнить программу. Эта программа может заменить находящийся в буфере текст найденными телефонными номерами и адресами электронной почты.

### План программы, что должна делать программа:
+ получать текст из буфера обмена;
+ находить в тексте все телефонные номера и адреса электронной почты;
+ переносить найденный текст в буфер обмена.


### Реализация всего вышеуказанного в виде кода. Код выполняет следующие операции:
+ использует модуль pyperclip для копирования и вставки строк;
+ создаёт два регулярных выражения, первое из которых соответствует телефонным номерам, а второе — адресам электронной почты;
+ находит все совпадения, а не только первое, для обоих регулярных выражений;
+ аккуратно форматирует найденные строки, преобразуя их в одну строку для вставки в буфер;
+ отображает соответствующее сообщение, если искомые соответствия в тексте не были обнаружены.

----------------------

#### **Регулярное выражение для поиска телефонных номеров**

Телефонный номер начинается с кода страны в котором одна цифра со знаком плюс либо без знака плюс `(\d{1} | \+\d{1})` 

В качестве разделителя групп цифр в телефонном номере могут использоваться пробел (\s), дефис (-) или точка (.), поэтому данные компоненты регулярного выражения также должны быть соединены символами канала, вот так `(\s | - | \.)?`

Поскольку территориальный код может иметь ровно три цифры `(\d{3})`. 

Снова  может идти разделитель `(\s | - | \.)?`

В следующих трех компонентах нет ничего сложного: три цифры `(\d{3})`, 

за которыми следует другой разделитель `(\s | - | \.)?`,

а затем еще четыре цифры `(\d{4})`.

-----------------------------

#### **Регулярное выражение для поиска адресов электронных почт**
Часть адреса, содержащая имя пользователя, включает один или более символов, которыми могут быть любые из следующих символов: буквы в верхнем или нижнем регистре, цифры, точка, символ подчеркивания, знак процента, знак “плюс” и дефис. Все эти символы можно указать в виде символьного класса: `[a-zA-Z0-9._%+-]+`

Имя домена отделяется от имени пользователя символом `@`

Доменное имя представляется с помощью более узкого класса, включающего только буквы, цифры, точку и дефис: `[a-zA-Z0-9.-]+`

А последняя, так называемая часть “dot-com” (с технической точки зрения представляющая домен верхнего уровня), фактически может содержать только точку и любой текст. Эта часть может включать от двух до четырех символов.  `(\.[a-zA-Z]{2,4})` 

Формат адресов электронной почты определяется многими, подчас причудливыми, правилами. Данному регулярному выражению будут соответствовать не все корректные адреса электронной почты, но его будет достаточно почти для всех видов электронных адресов, с которыми можем столкнуться.

______________________________

#### **Поиск всех совпадений в тексте, скопированном в буфере обмена**
Модуль re выполняет утомительную работу по поиску в буфере обмена всех строк, соответствующих составленным регулярным выражением. Метод pyperclip.paste() получает строковое значение текста, хранящегося в буфере обмена, а метод findall() возрощает список кортежей.

Для каждого совпадения создается один кортеж, и каждый кортеж содержит строки для каждой группы в регулярном выражении. В группе 0 соответствует все регулярное выражение, поэтому нужно - это группа с индексом 0 в кортеже.

Найденные совпадения с регулярным выражением сохраняются в списке matches. Поначалу этот список говорит пуст  `matches = []`. 

Далее следующие два цикла for 
```
for groups in phoneRegex.findall(text):
	phoneNum = '-'.join([groups[1], groups[3], groups[5], groups[7]])
	matches.append(phoneNum)
```

В случае адресов электронной почты достаточно присоединить к списку matches группу 0 каждого найденного совпадения 
```
for groups in emailRegex.findall(text):
	matches.append(groups[0])
```

В случае же телефонных номеров мы не можем ограничиться только этим. Поскольку программа ищет телефонные номера, формат которых может быть различным, то, прежде чем присоединиться их к списку, их нужно привести к единому стандартному формату. В переменной phoneNum содержится строка, скомпонованная из групп  (этими группами являются код страны, территориальный код, первые три цифры, последние четыре цифры).  

________________________

#### **Объединение совпадений в одну строку для копирования в буфер обмена**

Когда адреса электронной почты и телефонные номера сохранены в matches, их копируют в буфер обмена. Функция pyperclip.copy() принимает одиночное строковое значение, а не список строк, поэтому для переменной matches вызывается метод join().

Выводит все найденные совпадения на экран. А если ни телефонных номеров, ни адресов электронной почты в тексте не найдено, будет выведено соответствующее сообщение.

### Выполнение программы

1. Открыть браузер на любом сайте с телефонными номерами и электронными почтами.
2. Нажать комбинацию клавиш <Ctrl+A> для выделения всего текста на странице.
3. Нажать комбинацию клавиш <Ctrl+C> для копирования этого текста в буфер.
4. Выполнить программу, получим скопированные телефонные номера и электронные почты.


![PyPI - Python Version](https://img.shields.io/pypi/pyversions/pillow?color=red)